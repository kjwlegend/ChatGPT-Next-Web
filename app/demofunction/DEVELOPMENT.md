# 思维导图开发记录

## 已完成功能

### 1. 基础节点操作
- [x] 双击编辑节点内容
- [x] 右键菜单操作（添加子节点、删除节点）
- [x] 节点拖拽和选择
- [x] 节点连接点（左侧目标点，右侧源点）

### 2. 快捷键支持
- [x] Enter 添加同级节点
- [x] Shift+Enter 添加子节点
- [x] Delete 删除节点
- [x] Ctrl+Z/Ctrl+Shift+Z 撤销/重做

### 3. 节点连接
- [x] 从右侧源点到左侧目标点的连接
- [x] 拖拽创建新节点
- [x] 自动布局避免重叠

### 4. 数据导入导出
- [x] JSON 格式导入导出
- [x] Markdown 格式导入导出
- [x] 列表格式支持

## 进行中功能

### 1. 布局优化
- [ ] 改进自动布局算法
- [ ] 支持垂直布局模式
- [ ] 节点自动对齐
- [ ] 画布缩放和居中优化

## 计划功能

### 1. AI 辅助功能
- [ ] 节点内容优化
  - 自动改写节点内容，使其更专业/通俗
  - 自动纠正语法和表达
  - 多语言翻译支持
  
- [ ] 智能节点扩展
  - 基于当前节点自动生成子节点
  - 智能补充相关概念
  - 自动生成对立/相关观点
  
- [ ] 结构优化建议
  - 分析并优化思维导图结构
  - 提供层级调整建议
  - 智能合并相似节点
  
- [ ] 内容丰富化
  - 自动添加定义和解释
  - 生成相关例子
  - 补充专业术语解释

- [ ] 上下文理解
  - 理解整体思维导图上下文
  - 提供全局优化建议
  - 检测逻辑关系完整性

- [ ] AI 对话功能
  - 基于思维导图进行对话
  - 通过对话修改/扩展导图
  - 导图内容解释和讲解

### 2. 节点样式增强
- [ ] 节点主题系统
- [ ] 节点折叠/展开功能
- [ ] 自定义节点图标
- [ ] 节点大小自适应
- [ ] 连线样式定制

### 3. 交互优化
- [ ] 节点多选操作
- [ ] 更多快捷键支持
- [ ] 右键菜单功能扩展
- [ ] 拖拽时的对齐辅助线

### 4. 数据持久化
- [ ] 本地存储支持
- [ ] 导出为图片
- [ ] 自动保存功能

### 5. 性能优化
- [ ] 大数据量渲染优化
- [ ] 虚拟化滚动
- [ ] 状态管理优化
- [ ] 减少不必要的重渲染

### 6. 功能扩展
- [ ] 节点搜索功能
- [ ] 节点分组功能
- [ ] 历史记录查看
- [ ] 协作功能支持
- [ ] AI 会话历史记录
- [ ] AI 个性化设置
  - 语言风格设置
  - 专业程度调整
  - 输出详细度控制

## 问题修复记录

### 2024-03-21
1. 修复了节点编辑状态管理问题
2. 修复了快捷键冲突问题
3. 改进了节点连接的视觉反馈

### 2024-03-22
1. 修复了 Markdown 导入时的层级解析问题
2. 改进了节点位置计算逻辑
3. 修复了类型定义问题

## 代码重构记录

### 2024-03-22
1. 优化了数据导入导出功能
   - 拆分为独立的 hooks
   - 改进错误处理
   - 统一文件命名和下载逻辑

2. 改进了代码组织
   - 实现关注点分离
   - 提高代码复用性
   - 优化错误处理和用户反馈

## 开发笔记

### AI 功能设计
- 使用 OpenAI API 作为基础模型
- 设计合适的 Prompt 模板
- 实现流式响应
- 优化 AI 响应速度
- 控制 token 使用量

### 用户体验优化
- 提供 AI 处理进度反馈
- 支持取消 AI 操作
- AI 建议的可视化展示
- 操作历史可回溯

### 性能考虑
- AI 请求的缓存策略
- 减少不必要的 API 调用
- 优化响应处理逻辑

## 下一步计划
1. 完善布局算法
2. 实现节点折叠功能
3. 添加更多快捷键支持
4. 优化性能
5. 集成 AI 基础功能
   - 优先实现节点内容优化
   - 添加智能节点扩展
   - 实现基础对话功能